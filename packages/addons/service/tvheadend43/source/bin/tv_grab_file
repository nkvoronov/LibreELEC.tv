#!/bin/sh

# SPDX-License-Identifier: GPL-2.0-or-later
# Copyright (C) 2016-present Team LibreELEC (https://libreelec.tv)

. /etc/profile

ADDON_HOME="$HOME/.kodi/userdata/addon_data/service.tvheadend43"
ADDON_SETTINGS="$ADDON_HOME/settings.xml"
XMLTV_TYPE=`grep XMLTV_TYPE $ADDON_SETTINGS | awk '{print $3 }' | sed -e "s,value=,," -e "s,\",,g"`
XMLTV_LOCATION_FILE=`grep XMLTV_LOCATION_FILE $ADDON_SETTINGS | awk '{print $3 }' | sed -e "s,value=,," -e "s,\",,g"`
XMLTV_LOCATION_WEB=`grep XMLTV_LOCATION_WEB $ADDON_SETTINGS | awk '{print $3 }' | sed -e "s,value=,," -e "s,\",,g"`
XMLTV_LOCATION_SCRIPT=`grep XMLTV_LOCATION_SCRIPT $ADDON_SETTINGS | awk '{print $3 }' | sed -e "s,value=,," -e "s,\",,g"`

if [ "$XMLTV_TYPE" = "file" ]; then
  cat "$XMLTV_LOCATION_FILE"
  exit 0
elif [ "$XMLTV_TYPE" = "script" ]; then
  if [ -e "$XMLTV_LOCATION_SCRIPT" ] ; then
    exec "$XMLTV_LOCATION_SCRIPT"
  fi
elif [ "$XMLTV_TYPE" = "web" ]; then
  wget -qO - "$XMLTV_LOCATION_WEB"
  exit 0
fi
